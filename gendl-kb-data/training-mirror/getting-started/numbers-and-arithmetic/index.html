<!DOCTYPE HTML><html lang="en"><head><title>Numbers and Arithmetic</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Numbers and Arithmetic</h2><p><a class="text-red-500" href="/getting-started/object-definition/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/positioning-and-orientation/index.html">Next-&gt;</a></p><p>In the <em><b><a href="../object-definition/index.html">Defining Objects</a></b></em> section, we briefly touched on numbers and arithmetic</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-4 (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">(length</span><span class="code" style="margin-left: 14px;">(width 4)</span><span class="code" style="margin-left: 14px;">(height 4)))</span><span class="code" style="margin-left: 7px;">:computed-slots</span><span class="code" style="margin-left: 7px;">((density 7800)</span><span class="code" style="margin-left: 14px;">(mass (* (div (the volume) 1000000000) (the density)))))</span></pre></div><p>In this section we will take a bit more detailed look at how GendL handles numbers and arithmetic.</p><p>The majority of this is pure Common Lisp (CL), although GendL does define a few <em>Convenience Functions</em> which may be classed as arithmetic. </p><p>CL has four number types:<ul><li>Integers (e.g. <span class="value">1</span>, <span class="value">38</span>, <span class="value">183749372628</span>)</li><li>Floating Point (e.g. <span class="value">253.67</span>, <span class="value">2.52E+26</span>)</li><li>Ratios (e.g. <span class="value">6/7</span>, <span class="value">347/395</span>)</li></ul><li>Complex (e.g. <span class="value">(#C(0 5)</span>, representing the square root of -25)</li></p><p>In contrast with other languages, you don't need to worry too much
about the type of number you are using, as the CL runtime system will
sort that out for us (unless you need to intervene for specific
performance reasons by bypassing the dynamic typing feature).</p><p>CL can handle rational numbers with "infinite" precision. For
example, the number <span class="value">1/3</span> represents one-third with no loss of precision as happens with the decimal representation of <span class="value">0.33333...</span> truncated to some arbitray number of decimal places.</p><p>And there is no realistic limit on the maximum size of a number that
CL can represent (although Integers up to a certain size may be
processed more efficiently than arbitrarily huge Integers).</p><h3>Arithmetic functions</h3><p>There are four basic CL arithmetic functions<ul><li><span class="function">+</span></li><li><span class="function">-</span></li><li><span class="function">*</span></li><li><span class="function">/</span></li></ul>Additionally GendL defines a fifth:<ul><li><span class="function">div</span></li></ul>and two <em>shortcut</em> functions<ul><li><span class="function">half</span></li><li><span class="function">twice</span></li></ul></p><p>As with all Lisp dialects, CL  uses prefix notation for
functions. All five basic arithmetic functions (<span class="function">+</span>, <span class="function">-</span>, <span class="function">*</span>, <span class="function">/</span>, and <span class="function">div</span>) can take one or more arguments, while <span class="function">+</span> and <span class="function">*</span> can also take zero arguments.</p><h4>CL function <span class="function">+</span></h4><p>The return value from <span class="function">+</span> depends on the number of arguments it is given.<ul><li>Zero Arguments - returns <span class="value">0</span></li><li>One Argument - returns the argument</li><li>Two or more arguments - returns the sum of all the arguments</li></ul></p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(+)</span></p><span class="output">0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(+ 5)</span></p><span class="output">5</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(+ 5 1 9 2)</span></p><span class="output">17</span></pre></div><p>Also note that because Lisp evaluates functions inside-out, (+ 1 2 3) is equivalent to (+ (+ 1 2) 3)</p><p>More about functions later.</p><h4>CL function <span class="function">-</span></h4><p>The <span class="function">-</span> function requires at least one argument. If no arguments are supplied, then an error will result.</p><p>The return value from <span class="function">-</span> depends on the number of arguments it is given.<ul><li>One Argument - returns the negative value of the supplied argument</li><li>Two or more arguments - accumulates the value of each argument subrtacted from the previous argument and returns the final result.</li></ul></p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(- 5)</span></p><span class="output">-5</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(- 5 1 9 2)</span></p><span class="output">-7</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(- 1 -5)</span></p><span class="output">6</span></pre></div><h4>CL function <span class="function">*</span></h4><p>The return value from <span class="function">*</span> depends on the number of arguments it is given.<ul><li>Zero Arguments - returns <span class="value">1</span>.</li><li>One Argument - returns the argument.</li><li>Two or more arguments - returns the product of all the arguments.</li></ul></p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(*)</span></p><span class="output">1</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(* 2)</span></p><span class="output">2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(* 2 3 4)</span></p><span class="output">24</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(* 2 -3 4)</span></p><span class="output">-24</span></pre></div><h4>CL function <span class="function">/</span></h4><p>The <span class="function">/</span> requires at least one argument. If no arguments are supplied, then an error will result.</p><p>The return value from <span class="function">/</span> depends on the number of arguments it is given and the value of the result<ul><li>One Argument - returns the reciprocal of the argument as a ratio (1/argument).</li><li>Two or more arguments - returns the value of the first argument
divided by the product of the remaining arguments. If the resulting
answer is a whole number, then the return value will be a whole number.
Otherwise it will be a ratio with the least possible whole denominator.</li></ul></p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ 3)</span></p><span class="output">1/3</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ 10 2)</span></p><span class="output">5</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ 10 3)</span></p><span class="output">10/3</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ 10 2 5)</span></p><span class="output">1</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ 10 1 6)</span></p><span class="output">5/3</span></pre></div><h4>GendL function <span class="function">div</span></h4><p>The GendL function <span class="function">div</span> is identical in operation to the Lisp function <span class="function">/</span> except it uses rational division and converts the return value to a floating point number</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(div 3)</span></p><span class="output">0.3333333333333333</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(div 10 2)</span></p><span class="output">5.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(div 10 3)</span></p><span class="output">3.3333333333333333</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(div 10 2 5)</span></p><span class="output">1.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(div 10 1 6)</span></p><span class="output">1.6666666666666667</span></pre></div><h4>GendL function <span class="function">half</span></h4><p>The GendL function <span class="function">half</span> takes a single argument and returns the result of dividing that
argument by the integer <span class="value">2</span>. The type of the returned number will depend on the type of the argument</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(half 5)</span></p><span class="output">5/2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(half 5.0)</span></p><span class="output">2.5</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(half 5/3)</span></p><span class="output">5/6</span></pre></div><h4>GendL function <span class="function">twice</span></h4><p>The GendL function <span class="function">twice</span> takes a single argument and returns the result of multiplying The
argument by the integer <span class="value">2</span>. The type of the returned number will depend
on the type of the argument.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(twice 5)</span></p><span class="output">10</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(twice 5.0)</span></p><span class="output">10.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(twice 5/3)</span></p><span class="output">10/3</span></pre></div><h3>Arithmetic Precedence</h3><p>Due to Lisp's generalized prefix notation for functions, and the
basic rule that functions are evaluated inside-out (in other words,
the innermost functions are evaluated first), precedence of arithmetic
operators is completely explicit in Lisp. The example below shows
conceptually how a long arithmetic expression is broken down during
evaluation</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ (* (+ 2 3) (- 3 4)) (* (- 2 6) (+ 2 (* 2 3))))</span></p><span class="output">5/32</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ (* (+ 2 3) (- 3 4)) (* (- 2 6) (+ 2 6)))</span></p><span class="output">5/32</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ (* 5 -1) (* -4 8))</span></p><span class="output">5/32</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(/ -5 -32)</span></p><span class="output">5/32</span></pre></div><p>So back to our code, <span class="object">my-box-4</span></p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-4 (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">(length</span><span class="code" style="margin-left: 14px;">(width 4)</span><span class="code" style="margin-left: 14px;">(height 4)))</span><span class="code" style="margin-left: 7px;">:computed-slots</span><span class="code" style="margin-left: 7px;">((density 7800)</span><span class="code" style="margin-left: 14px;">(mass (* (div (the volume) 1000000000) (the density)))))</span></pre></div><p>In the <span class="object-keyword">:computed-slots</span>, <span class="slot">density</span> has been assigned the value of <span class="value">7800</span>.</p><p>Because the box dimensions are in mm, and the <span class="slot">density</span> is in kg/m<sup>3</sup>, we first divide the <span class="slot">volume</span> by <span class="value">1000000000</span> to convert into cubic metres. We then multiply this result by the value of <span class="slot">density</span> to get the mass in kg. The result will always be a floating point number, since <span class="function">div</span> indeed always returns a floating point number.</p><div class="main-page-item"><h2>Resources</h2><table><tr><td><a href="/t2-resources/numbers.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/numbers.lisp">numbers.lisp</a></td></tr></table></div></div></div></div></body></html>