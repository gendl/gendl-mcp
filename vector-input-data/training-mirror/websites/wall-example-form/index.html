<!DOCTYPE HTML><html lang="en"><head><title>Wall example - taking inputs from a form</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Wall example - taking inputs from a form</h2><p><a class="text-red-500" href="/websites/displaying-graphics/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/websites/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/websites/building-example-file/index.html">Next-&gt;</a></p><div class="main-page-container"><div class="main-page-item"><div class="grid-container-2-650px"><div class="grid-item"></div><p>In the tutorial <a href="/getting-started/index.html">Getting started with GendL</a> we developed an example application to build a model of a brick built wall. In that application, all inputs were provided as <span class="object-keyword">input-slots</span> with default values. In this topic, we'll use the wall application and extend it to include a web based front end to gather inputs via a form.</p><p>The basic design concept is to have a web page as a top level object, which gathers the inputs and passes them to the wall application, which is defined as a child object of the web form. We will then retrieve the outputs from the wall application and display these on the web form</p><p>So first, we need to familiarise ourselves with the required inputs</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object wall(box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">((brick-height 45)</span><span class="code" style="margin-left: 14px;">(brick-length 180)</span><span class="code" style="margin-left: 14px;">(brick-width 90)</span><span class="code" style="margin-left: 14px;">(mortar-joint-width 10)</span><span class="code" style="margin-left: 14px;">(wall-length 3700)</span><span class="code" style="margin-left: 14px;">(wall-height 900))</span><span class="code" style="margin-left: 0px;">...</span><span class="code" style="margin-left: 0px;">)</span></pre></div><p>Now we define the <span class="object">form-controls</span> to capture these inputs</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object wall-example-form (base-html-page)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((brick-height-fc :type 'number-form-control</span><span class="code" style="margin-left: 154px;">:prompt "Brick Height (mm)"</span><span class="code" style="margin-left: 154px;">:default 45</span><span class="code" style="margin-left: 154px;">:ajax-submit-on-change? t)</span><span class="code" style="margin-left: 14px;">(brick-length-fc :type 'number-form-control</span><span class="code" style="margin-left: 154px;">:default 180</span><span class="code" style="margin-left: 154px;">:prompt "Brick Length (mm)"</span><span class="code" style="margin-left: 154px;">:ajax-submit-on-change? t)</span><span class="code" style="margin-left: 14px;">(brick-width-fc :type 'number-form-control</span><span class="code" style="margin-left: 147px;">:default 90</span><span class="code" style="margin-left: 147px;">:prompt "Brick Width (mm)"</span><span class="code" style="margin-left: 147px;">:ajax-submit-on-change? t)</span><span class="code" style="margin-left: 14px;">(mortar-width-fc :type 'number-form-control</span><span class="code" style="margin-left: 154px;">:default 10</span><span class="code" style="margin-left: 154px;">:prompt "Mortar Joint Width (mm)"</span><span class="code" style="margin-left: 154px;">:ajax-submit-on-change? t)</span><span class="code" style="margin-left: 14px;">(wall-length :type 'number-form-control</span><span class="code" style="margin-left: 126px;">:default 3700</span><span class="code" style="margin-left: 126px;">:prompt "Nominal Wall Length (mm)"</span><span class="code" style="margin-left: 126px;">:ajax-submit-on-change? t)</span><span class="code" style="margin-left: 14px;">(wall-height :type 'number-form-control</span><span class="code" style="margin-left: 126px;">:default 3700</span><span class="code" style="margin-left: 126px;">:prompt "Nominal Wall Height (mm)"</span><span class="code" style="margin-left: 126px;">:ajax-submit-on-change? t)))</span></pre></div><p>Having done that, we need to present them on the web page; using a <span class="object">base-html-div</span> is a convenient way to do this. Note that we use the <span class="slot">form-controls</span> slot to iterate through all the <span class="object">form-control</span> objects to present them on the web page. Also we would normally define <span class="object-keyword">validation-function</span> inputs, but have skipped those in this example</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object wall-example-form (base-html-page)</span><span class="code" style="margin-left: 7px;">:computed-slots</span><span class="code" style="margin-left: 7px;">((main-sheet-body (with-lhtml-string ()</span><span class="code" style="margin-left: 147px;">(:table</span><span class="code" style="margin-left: 161px;">(:tr</span><span class="code" style="margin-left: 175px;">(:td (str (the form-controls-section div))))))))</span><span class="code" style="margin-left: 0px;">:objects</span><span class="code" style="margin-left: 7px;">((form-controls-section </span><span class="code" style="margin-left: 63px;">:type 'base-html-div</span><span class="code" style="margin-left: 63px;">:inner-html (with-lhtml-string ()</span><span class="code" style="margin-left: 175px;">(:table</span><span class="code" style="margin-left: 189px;">(dolist (obj (the form-controls))</span><span class="code" style="margin-left: 203px;">(htm (:tr (:td (str (theo obj prompt)))</span><span class="code" style="margin-left: 294px;">(:td (str (theo obj form-control)))))))))</span><span class="code" style="margin-left: 0px;">...</span><span class="code" style="margin-left: 0px;">))</span></pre></div><p>Then we need to link the  <span class="object">form-control</span> <span class="slot">value</span> slots to the <span class="object-keyword">:inputs</span> to the wall object</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object wall-example-form (base-html-page)</span><span class="code" style="margin-left: 0px;">...</span><span class="code" style="margin-left: 0px;">...</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((wall :type 'gdl-user::wall</span><span class="code" style="margin-left: 70px;">:brick-height (the brick-height-fc value)</span><span class="code" style="margin-left: 70px;">:brick-length (the brick-length-fc value)</span><span class="code" style="margin-left: 70px;">:brick-width (the brick-width-fc value)</span><span class="code" style="margin-left: 70px;">:mortar-joint-width (the mortar-width-fc value)</span><span class="code" style="margin-left: 70px;">:wall-length (the wall-length value)</span><span class="code" style="margin-left: 70px;">:wall-height  (the wall-height value))</span><span class="code" style="margin-left: 14px;">...</span><span class="code" style="margin-left: 14px;">...</span><span class="code" style="margin-left: 0px;">)</span><span class="code" style="margin-left: 0px;">)</span></pre></div><p>Finally, we need to define a <span class="object">base-html-div</span> to present the wall outputs on the web page. Because all of the <span class="object">form-control</span> objects have been defined with <span class="object-keyword">:ajax-submit-on-change?</span> set to T, any change to the form inputs will automatically trigger an update to the outputs display</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object wall-example-form (base-html-page)</span><span class="code" style="margin-left: 7px;">:computed-slots</span><span class="code" style="margin-left: 7px;">((main-sheet-body (with-lhtml-string ()</span><span class="code" style="margin-left: 154px;">(:table </span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td (str (the form-controls-section div)))</span><span class="code" style="margin-left: 182px;">(:td (str (the report-section div)))))))</span><span class="code" style="margin-left: 7px;">)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">(</span><span class="code" style="margin-left: 21px;">...</span><span class="code" style="margin-left: 21px;">...</span><span class="code" style="margin-left: 14px;">(report-section </span><span class="code" style="margin-left: 49px;">:type 'base-html-div</span><span class="code" style="margin-left: 49px;">:inner-html (with-lhtml-string ()</span><span class="code" style="margin-left: 154px;">(:table</span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td "Actual Wall Length")</span><span class="code" style="margin-left: 182px;">(:td (str (the wall actual-wall-length))))</span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td "Actual Wall Height")</span><span class="code" style="margin-left: 182px;">(:td (str (the wall actual-wall-height))))</span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td "Number of Full Bricks")</span><span class="code" style="margin-left: 182px;">(:td (str (the wall full-bricks))))</span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td "Number of Half Bricks")</span><span class="code" style="margin-left: 182px;">(:td (str (the wall half-bricks))))</span><span class="code" style="margin-left: 168px;">(:tr </span><span class="code" style="margin-left: 182px;">(:td "Mortar Mass")</span><span class="code" style="margin-left: 182px;">(:td (fmt "~,1f" (the wall mortar-mass)))))))</span><span class="code" style="margin-left: 63px;">...</span><span class="code" style="margin-left: 63px;">...</span><span class="code" style="margin-left: 14px;">))</span></pre></div><image src="/t6-images/building-example.png" style="border: 2px solid; margin: 5px 0 0 3% ;width: auto; height: 200px;"></image></div><div class="main-page-item"><h2>Resources</h2><table><tr><td><a href="/t6-resources/gwl-patches.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t6-resources/gwl-patches.lisp">gwl-patches.lisp</a></td></tr><tr><td><a href="/t6-resources/wall.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t6-resources/wall.lisp">wall.lisp</a></td></tr><tr><td><a href="/t6-resources/wall-example-form.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t6-resources/wall-example-form.lisp">wall-example-form.lisp</a></td></tr></table></div></div></div></div></div></div></body></html>