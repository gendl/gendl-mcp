<!DOCTYPE HTML><html lang="en"><head><title>Positioning and Orientation</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Positioning and Orientation</h2><p><a class="text-red-500" href="/getting-started/numbers-and-arithmetic/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/object-sequences/index.html">Next-&gt;</a></p><h2><h2>Positioning and Orientation</h2><p><a class="text-red-500" href="/getting-started/numbers-and-arithmetic/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/object-sequences/index.html">Next-&gt;</a></p></h2><div class="main-page-container"><div class="main-page-item"><div class="main-page-container"><div class="main-page-item"><p>For geometric objects, GendL has a Cartesian axis system to specify coördinates in the X, Y and Z dimensions. </p><p>When specifying a geometric object, a number of basic principles apply:</p><ul><li>The axis system applies to the object, but may be moved or re-oriented relative to other objects.</li><li>The <span class="slot">center</span> of the object is co-incident with the origin of its axis system <span class="value">#(0.0 0.0 0.0)</span>.</li><li>The <span class="slot">length</span> dimension of the geometric object correponds with the Y axis.</li><li>The <span class="slot">width</span> dimension of the geometric object corresponds with the X axis.</li><li>The <span class="slot">height</span> dimension of the geometric object corresponds with the Z axis.</li></ul></div><div class="main-page-item"></div><div class="main-page-item"><img src="/t2-images/xyz-length-width-height.png" style="width: auto; height: 200px;" /></div><div class="main-page-item"></div><div class="main-page-item"><h3>Positioning</h3><p>By default, the positioning of the center point of a child object is
identical to the center point of its parent. (This is because <span class="slot">center</span> is declared internally to be <em>trickle-down</em>. We will cover more about <span class="object-keyword">trickle-down-slots</span> and the <code>defaulting</code> slot modifier later.</p><p>If you would like to override the default <span class="slot">center</span> which "trickles down" from the <span class="slot">parent</span> or a higher ancestor in the tree, then you may position them explicitly,
either in an absolute manner (i.e. relative to the global coördinate system), or in a relative
manner (i.e. relative to another object, typically the direct parent), by feeding an explicit <span class="general-keyword">:center</span> input into the child.  Depending on how you specify that <span class="general-keyword">:center</span>, the child will end up positioned relative to the parent (or to another object), or relative to the global coördinate system.</p><p>Consider the following object definition and its display in Geysr:</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object assembly-2 (base-object)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((box-1 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:width 1</span><span class="code" style="margin-left: 63px;">:height 1)</span><span class="code" style="margin-left: 14px;">(box-2 :type 'box</span><span class="code" style="margin-left: 63px;">:length 10</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 3</span><span class="code" style="margin-left: 63px;">:center (make-point 2 2 2))</span><span class="code" style="margin-left: 14px;">(box-3 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 5</span><span class="code" style="margin-left: 63px;">:center (translate-along-vector</span><span class="code" style="margin-left: 133px;">(the box-2 center)</span><span class="code" style="margin-left: 133px;">(make-vector 1 1 0)</span><span class="code" style="margin-left: 133px;">5))))</span></pre></div></div><div class="main-page-item"><img src="/t2-images/box-position.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"><p><span class="object">box-1</span> does not specify a <span class="slot">center</span>, so its center will default to that of its parent, or <span class="value">#(0.0 0.0 0.0)</span>.  Note in this case the parent (<span class="object">assembly-1</span>) is defined to include the <span class="object">base-object</span> mixin - this provides the basic coördinate system without providing any explicit geometry.</p><p><span class="object">box-2</span> defines an explicit <span class="slot">center</span> using the GendL <span class="macro">make-point</span> macro. The coördinates of this point are defined in absolute global coördinates by
passing numbers directly into that <span class="function">make-point</span> macro.</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(make-point 2 2 2)</span></p><span class="output">#(2.0 2.0 2.0)</span></pre></div></div><div class="main-page-item"></div><div class="main-page-item"><p></p><p>box-3 defines its <span class="slot">center</span> relative to the <span class="slot">center</span> of <span class="slot">box-2</span> instance by using the <span class="function">translate-along-vector</span> function. <span class="function">translate-along-vector</span> takes the following inputs:<ul><li>a 3d-point which is to be translated, in this case the center of box-2;</li><li>a vector which specifies the direction of translation - in this case we are translating in the direction pointed to
by an arrow from the origin to one unit in the X direction, one unit in the Y direction and zero units in the Z direction;</li><li>the distance by which the point it to be translated</li></ul>The coördinates of the resulting point are again defined in the coördinate system of the parent.</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'assembly-2))</span></p><span class="output">#&#60;ASSEMBLY-2 #x210462875D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(translate-along-vector (the box-2 center) (make-vector 1 1 0) 5)</span></p><span class="output">#(5.535533905932738 5.535533905932738 2.0)</span></pre></div></div><div class="main-page-item"></div><div class="main-page-item"><p>Sometimes it is useful to access points and vectors relative to the reference box of the objects you create. When you create a <span class="object">box</span> for example (whose reference box is identical with itself), the faces of the box are identified as <span class="general-keyword">:top</span>, <span class="general-keyword">:bottom</span>, <span class="general-keyword">:left</span>, <span class="general-keyword">:right</span>, <span class="general-keyword">:front</span> and <span class="general-keyword">:rear</span></p></div><div class="main-page-item"></div><div class="main-page-item"><img src="/t2-images/face-notation.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"></div><div class="main-page-item"><p>Various points relative to the bounding-box may then be accessed using the GendL <span class="object-keyword">:functions</span> <span class="function">face-center</span>, <span class="function">edge-center</span> and <span class="function">vertex</span>, whilst vectors may be created normal to a face using the GendL <span class="object-keyword">:function</span> <span class="function">face-normal-vector</span>. </p></div><div class="main-page-item"></div><div class="main-page-item"><img src="/t2-images/points-and-vector-from-faces.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"></div><div class="main-page-item"><p>So if you wished to position the 3 boxes in <span class="object">assemby-3</span> such that the rear and front faces of adjoining boxes were coincident, you could achieve that with the following code:</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object assembly-3 (base-object)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((box-1 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:width 1</span><span class="code" style="margin-left: 63px;">:height 1)</span><span class="code" style="margin-left: 14px;">(box-2 :type 'box</span><span class="code" style="margin-left: 63px;">:length 10</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 3</span><span class="code" style="margin-left: 63px;">:center (translate-along-vector</span><span class="code" style="margin-left: 133px;">(the box-1 (face-center :rear))</span><span class="code" style="margin-left: 133px;">(the box-1 (face-normal-vector :rear))</span><span class="code" style="margin-left: 133px;">(half (the-child length))))</span><span class="code" style="margin-left: 14px;">(box-3 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 5</span><span class="code" style="margin-left: 63px;">:center (translate-along-vector</span><span class="code" style="margin-left: 140px;">(the box-2 (face-center :rear))</span><span class="code" style="margin-left: 140px;">(the box-2 (face-normal-vector :rear))</span><span class="code" style="margin-left: 140px;">(half (the-child length)))))</span></pre></div></div><div class="main-page-item"><img src="/t2-images/box-coincident-face.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"><p>Two important concepts are also introduced here<ul><li>When referencing a GendL function, you can use a normal referencing chain, but if the function has arguments
then you need to wrap that function and its arguments in parentheses. We see examples of this when using the <span class="function">face-center</span> and <span class="function">face-normal-vector</span> functions</li></ul></p></div><div class="main-page-item"></div><div class="main-page-item"><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'assembly-3))</span></p><span class="output">#&#60;ASSEMBLY-3 #x210494BB9D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the box-1 (face-center :rear))</span></p><span class="output">#(0.0 2.5 0.0)</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the box-1 (face-normal-vector :rear))</span></p><span class="output">#(0.0 1.0 0.0)</span></pre></div></div><div class="main-page-item"></div><div class="main-page-item"><ul><li>To refer to messages in the child object instances, you can use the macro <span class="macro">the-child</span>. In the case of <span class="slot">box-2</span> and <span class="slot">box-3</span>, we want to translate the point by half of each one's own <span class="slot">length</span></li></ul><p>. These points and vectors could, of cource be computed explicitly in
the parent object. However by computing them using expressions
relative to the child instances, you can ensure that the design will "hang
together" as intended, i.e. that front and rear faces of adjoining
boxes will continue to be touching, even if the <span class="slot">center</span> and/or <span class="slot">orientation</span> of the first box is changed.</p><h3>Orientation</h3><p>By default, the <span class="slot">orientation</span> of a child object is the same as that for its <span class="slot">parent</span> object. However, you can override that by specifying an <span class="object-keyword">:orientation</span> as an input to the child instance. To compute an orientation, you can use
the GendL <span class="function">alignment</span> <span class="object-keyword">function</span>, which will yield an orientation by aligning one, two, or three
specified axes of our child instance with one, two, or three specified vectors.</p><p>If you compute those specified vectors relative to the coördinate system of the current <span class="variable-name">self</span> (i.e. the <span class="slot">parent</span>, then the resultant <span class="slot">orientation</span> will also end up relative and will automatically respond to any changes.</p><p>The <span class="function">alignment</span> function requires at least one axis-vector pair,
but optionally can accept an additional two axis-vector pairs, providing the second axis
is orthogonal to the first and the third axis is orthogonal to the
first and second</p><p>In the example below, the <span class="general-keyword">:rear</span> axis of box-2 (aligned with the global positive Y axis, <span class="value">#(0.0 1.0 0.0)</span>, is aligned with the vector normal to the <span class="general-keyword">:top</span> face of <span class="slot">box-1</span>. The <span class="slot">center</span> of each box remains the default <span class="value">#(0.0 0.0 0.0)</span>.</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object assembly-4 (base-object)</span><span class="code" style="margin-left: 14px;">:objects</span><span class="code" style="margin-left: 14px;">((box-1 :type 'box</span><span class="code" style="margin-left: 70px;">:length 5</span><span class="code" style="margin-left: 70px;">:width 1</span><span class="code" style="margin-left: 70px;">:height 1)</span><span class="code" style="margin-left: 21px;">(box-2 :type 'box</span><span class="code" style="margin-left: 70px;">:length 5</span><span class="code" style="margin-left: 70px;">:width 1</span><span class="code" style="margin-left: 70px;">:height 1</span><span class="code" style="margin-left: 70px;">:orientation (alignment :rear (the box-1 (face-normal-vector :top)))))</span><span class="code" style="margin-left: 14px;">)</span></pre></div></div><div class="main-page-item"><img src="/t2-images/orientation-1.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"><p>In the example below, which is an extension of <span class="object">assembly-4</span>, by being more explicit about the <span class="slot">:orientation</span> being fed into <span class="slot">box-2</span> and <span class="slot">box-3</span>, and aligning them with the <span class="general-keyword">:rear</span> axis of each's neighbor, you can ensure that all boxes remain touching regardless of what <span class="slot">:orientation</span> may be specified in the future for <span class="slot">box-1</span>.</p></div><div class="main-page-item"></div><div class="main-page-item"><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object assembly-5 (base-object)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((box-1 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:width 1</span><span class="code" style="margin-left: 63px;">:height 1</span><span class="code" style="margin-left: 63px;">:orientation (alignment :rear (the (face-normal-vector :right))))</span><span class="code" style="margin-left: 14px;">(box-2 :type 'box</span><span class="code" style="margin-left: 63px;">:length 10</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 3</span><span class="code" style="margin-left: 63px;">:orientation (alignment :rear (the box-1 (face-normal-vector :rear)))</span><span class="code" style="margin-left: 63px;">:center (translate-along-vector (the box-1 (face-center :rear))</span><span class="code" style="margin-left: 287px;">(the box-1 (face-normal-vector :rear))</span><span class="code" style="margin-left: 287px;">(half (the-child length))))</span><span class="code" style="margin-left: 14px;">(box-3 :type 'box</span><span class="code" style="margin-left: 63px;">:length 5</span><span class="code" style="margin-left: 63px;">:height 5</span><span class="code" style="margin-left: 63px;">:width 5</span><span class="code" style="margin-left: 63px;">:orientation (alignment :rear (the box-2 (face-normal-vector :rear)))</span><span class="code" style="margin-left: 63px;">:center (translate-along-vector (the box-2 (face-center :rear))</span><span class="code" style="margin-left: 287px;">(the box-2 (face-normal-vector :rear))</span><span class="code" style="margin-left: 287px;">(half (the-child length)))</span></pre></div></div><div class="main-page-item"><img src="/t2-images/orientation-2.png" style="width: auto; height: 300px; margin: 1em 0 1em 3% ;" /></div><div class="main-page-item"><h3>Points and Vectors</h3><p>GendL provides a number of functions for manipulating points and vectors. The Resources file points-and-vectors.lisp gives
examples of the most common ones, summarised below. Note that this is not an exhaustive list.</p><h4>Vectors</h4><ul><li><span class="function">make-vector</span> - creates a vector</li><li><span class="function">face-normal-vector</span> - (GendL <span class="object-keyword">function</span>) returns a vector normal to a specified face</li><li><span class="function">subtract-vectors</span> - takes 2 3d points and returns the vector from the second point to the first point</li><li><span class="function">cross-vectors</span> - returns a vector that is orthogonal to the 2 input vectors</li><li><span class="function">rotate-vector</span> - rotates a vector around a normal vecort by an angle specified in radians</li><li><span class="function">rotate-vector-d</span> - rotates a vector around a normal vecort by an angle specified in degrees</li><li><span class="function">angle-between-vectors</span> - returns the angle between 2 vectors in radians</li><li><span class="function">angle-between-vectors-d</span> - returns the angle between 2 vectors in degrees</li></ul><h4>Points</h4><ul><li><span class="function">make-point</span> - creates a point</li><li><span class="function">3d-distance</span> - the distance between 2 points</li><li><span class="function">translate-along-vector</span> - returns a point resulting from translating the
specified point along the specified vector by the specified distance</li><li><span class="function">face-center</span> (GendL <span class="object-keyword">function</span>) - returns a point which is the center of a specified reference-box face</li><li><span class="function">edge-center</span> (GendL <span class="object-keyword">function</span>) - returns a point which is the center of a specified reference-box edge (coincidence of 2 specified reference-box faces)</li><li><span class="function">vertex</span> (GendL <span class="object-keyword">function</span>) - returns a point which is a vertex (coincidence of 3 specified reference-box faces)</li><li><span class="function">coincident-points?</span> - returns T is 2 points are within a given tolerance of each other</li><li><span class="function">get-x</span>, <span class="function">get-y</span>, <span class="function">get-z</span> - returns the X, Y or Z value of a specified point</li></ul><p>See the <a href="/yadd">online documentation</a> relating to the <span class="package-name">:GEOM-BASE</span> package for exact syntax and further details.</p></div></div></div></div><div class="main-page-item"><h2>Resources</h2><table><tr><td><a href="/t2-resources/axis-system.pdf"><img src="/common-images/pdf-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/axis-system.pdf">axis-system.pdf</a></td></tr><tr><td><a href="/t2-resources/positioning-and-orientation.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/positioning-and-orientation.lisp">positioning-and-orientation.lisp</a></td></tr><tr><td><a href="/t2-resources/point-and-vector-examples.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/point-and-vector-examples.lisp">point-and-vector-examples.lisp</a></td></tr></table></div></div></div></div></body></html>