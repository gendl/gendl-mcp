<!DOCTYPE HTML><html lang="en"><head><title>Instantiating objects in the REPL</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Instantiating objects in the REPL</h2><p><a class="text-red-500" href="/getting-started/gendl-intro/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/instantiate-geysr/index.html">Next-&gt;</a></p><p>GendL includes a collection of object definitions which you can use
directly or customise/enhance to suit particular needs.</p><p>To work with instances of these objects you may choose to <em>instantiate</em> an object in the REPL. For example, to instantiate a GendL object of type <span class="object">box</span> in the REPL, we call GendL's general-purpose <span class="function">make-object</span> constructor function, which yields a freshly instantiated object which we assign to a symbol (<span class="variable-name">my-box</span>) in the below example), using the Lisp special operator <span class="special-operator">setq</span>. The <span class="function">make-object</span> function takes an object name as its required argument, followed by a
"spliced-in" list of alternating slot-names and corresponding
desired initial values. This type of list which is made up from
alternating key-value pairs is called a <i>plist</i>. You will learn more
about plists later.
                            
In the example below we are instantiating a wireframe volumetric <span class="object">box</span> and initializing its <span class="slot">length</span>, <span class="slot">width</span> and <span class="slot">height</span> slots to <span class="value">2</span>, <span class="value">3</span>, and <span class="value">4</span>, respectively.</p><p>Using the macro <span class="macro">the-object</span>, you can then "send a message" to this object, which yields the current
value of the requested slot.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq my-box (make-object 'box :length 2 :width 3 :height 4))</span></p><span class="output">#&#60;BOX #x210348222D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object my-box length)</span></p><span class="output">2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object my-box width)</span></p><span class="output">3</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object my-box height)</span></p><span class="output">4</span></pre></div><p>Note that <span class="special-operator">setq</span> is a standard CL special operator which takes one or more symbol-value
pairs, assigns the respective values to the symbols, and finally returns the last value.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq a 1)</span></p><span class="output">1</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq b 2 c "three" d nil)</span></p><span class="output">NIL</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">b</span></p><span class="output">2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">c</span></p><span class="output">three</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">d</span></p><span class="output">NIL</span></pre></div><p>As with most built-in primitives, The GendL <span class="object">box</span> supports a number of built-in messages, for example <span class="slot">volume</span>. To send the <span class="slot">volume</span> message to our <span class="variable-name">my-box</span> instance and get its value returned, we will need to use a <i>reference chain</i>. A reference chain consists of a reference operator such as <span class="macro">the-object</span>, followed by an expression which is expected
to return an object instance (the example below this expression is simply that <span class="variable-name">my-box</span> symbol).</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object my-box volume)</span></p><span class="output">24</span></pre></div><p>You can use the abbreviation <span class="macro">theo</span> rather than <span class="macro">the-object</span>. It does the same thing with less typing.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(theo my-box volume)</span></p><span class="output">24</span></pre></div><p>As an added convenience, you can assign the object to the special variable <span class="variable-name">self</span> rather than to an arbitrarily-named variable. If you take this approach, then rather than using <span class="macro">theo</span> or <span class="macro">the-object</span> to refer to an object expression explicitly when
sending a message, you now have the option of using the GendL macro <span class="macro">the</span> to send a message to the object, and automatically <span class="variable-name">self</span> will be assumed as the object to receive the message. </p><p>In the following REPL interaction, the last three expressions are equivalent with each other:</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'box :length 2 :width 3 :height 4))</span></p><span class="output">#&#60;BOX #x210348242D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">24</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object self volume)</span></p><span class="output">24</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(theo self volume)</span></p><span class="output">24</span></pre></div><p>While <span class="variable-name">self</span> is a normal symbol, it has a special meaning within the context of GendL.
It is fine to use <span class="variable-name"></span>self in the REPL, you should never bind or set/modify <span class="variable-name"></span>self within the body of a GendL object definition (created using the <span class="macro"></span>define-object macro)</p><p>As yet an additional convenience, you can use the built-in GendL function <span class="function">make-self</span> to instantiate an object and set it to the toplevel <span class="variable-name">self</span>, all in one fell swoop:</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(make-self 'box :length 1 :width 2 :height 3)</span></p><span class="output">#&#60;BOX #x210348242D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">6</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the-object self volume)</span></p><span class="output">6</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(theo self volume)</span></p><span class="output">6</span></pre></div><p>If you'd like to create a named "blueprint"
of an object instance, e.g. for being able to instantiate customized
boxes without needing to feed in customized slot values, then you may
use GendL's <span class="macro">define-object</span> macro. In the example below we are
defining a new object <span class="object">my-box</span>,  which is effectively a customisation of the default Gendl <span class="object">box</span> object, by specifying <span class="object">box</span> as part of its <i>mixin list</i>. More about <span class="macro">define-object</span> later.</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-1 (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">((length 2)</span><span class="code" style="margin-left: 14px;">(width 3)</span><span class="code" style="margin-left: 14px;">(height 4)))</span></pre></div><p>After this object definition has been compiled & loaded into the
running system (in Emacs/Slime this can be done with the cursor in the object and pressing C-c C-c),
then you can instantiate it in the REPL. Note that because the new object <span class="object">my-box</span> specifies default values for the <span class="object-keyword">:input-slots</span> , you do not need to feed them in when making instances of <span class="object">my-box</span> in the REPL</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-1))</span></p><span class="output">#&#60;BOX #x210344342D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">24</span></pre></div><p>However, you continue to have the ability to feed in alternative values of <span class="object-keyword">:input-slots</span> for <span class="object">my-box</span></p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-1 :length 8))</span></p><span class="output">#&#60;BOX #x210478242D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">96</span></pre></div><table><tr><td><a href="/t2-resources/my-box-1.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/my-box-1.lisp">my-box-1.lisp</a></td></tr></table></div></div></div></body></html>