<!DOCTYPE HTML><html lang="en"><head><title>Functions and :functions</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Functions and :functions</h2><p><a class="text-red-500" href="/getting-started/lists/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/equality/index.html">Next-&gt;</a></p><div class="main-page-container"><div class="main-page-item"><h2><h2>Functions and :functions</h2><p><a class="text-red-500" href="/getting-started/lists/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/equality/index.html">Next-&gt;</a></p></h2><div class="grid-container-2-650px"><div class="grid-item"><p><p>Functions are Lisp objects which can be <em>called</em>, or invoked, to </p><p>accept some <em>inputs</em> (or "arguments") and yield corresponding <em>outputs</em> or "return values." </p><p>Typically, functions will simply return new values without modifying </p><p>any of the inputs. If you program mostly with such a non-modifying </p><p>style, you are doing _Functional Programming. </p></p><p>GendL offers two kinds of functions:<ul><li>Functions defined using the <span class="macro">defun</span> macro, Sometimes called <em><b>Named Functions</b></em>, such functions become objects in memory which have a symbol for a name. Usually, variables mentioned within the body of such functions
are "passed in" to the function call as arguments, Variables with
Global and Dynamic Scope can also be accessed within function bodies,
but we will cover those types of variables later.</li><li>Functions defined within the <span class="object-keyword">:functions</span> section of a GendL object definition. As with toplevel <span class="macro">defun</span> functions, variables may be passed into <span class="object-keyword">:functions</span> as arguments and the function bodies may access
global data. But additionally, <span class="object-keyword">:functions</span> can also access any other <em><b>messages</b></em> defined within
the same GendL object type where they occur. <em><b>Messages</b></em> can be any of <ul><li><span class="object-keyword">:input-slots</span></li><li><span class="object-keyword">:computed-slots</span></li><li><span class="object-keyword">:objects</span></li></ul>... and other <span class="object-keyword">:functions</span> also count as messages!

When you want to access the value of other mesages within the same object instance, you can use the <span class="macro">the</span><em> referencing macro</em>.</li></ul></p><h3>Named functions</h3><p>We have already encountered a number of Named Functions, for example<ul><li><span class="function">+</span> which returns the sum of
the numbers supplied as arguments</li><li><span class="function">length</span> which returns
the length of a list supplied as an argument</li></ul></p><p>Named functions defined using the <span class="macro">defun</span> macro use <em><b>Prefix Notation</b></em>. In other words, the function
name is specified first, followed by its arguments. Named functions can accept <ul><li>Specific standard arguments, which immediately follow
the function name</li><li>Specific optional arguments, identified using <em><b>&optional</b></em> in the argument list</li><li>Specific keyword arguments, identified using <em><b>&key</b></em> in the argument list</li><li>Any number of remaining arguments, identified using <em><b>&rest</b></em> in the argument list</li></ul>We'll discuss standard, <em><b>&optional</b></em> and <em><b>&keyword</b></em> arguments in this tutorial and come back to <em><b>&rest arguments</b></em> in a later tutorial</p><h4>Standard arguments</h4><p>Here we define two functions with one and two arguments respectively.
In the second function, the ordering of the arguments is what determines which input value ends
up in which variable in the body of the function.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(defun add2 (x) (+ x 2))</span></p><span class="output">ADD2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(add2 4)</span></p><span class="output">6</span><span class="prompt" style="display: inline;">GDL-USER>&nbsp;&nbsp;</span><span class="command" style="margin-left: 0px;">(defun kinetic-energy (mass velocity)</span><span class="command-no-prefix" style="margin-left: 84px;">(div (* mass velocity velocity) 2))</span><span class="output">KINETIC-ENERGY</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy 5 12)</span></p><span class="output">360.0</span></pre></div><h4>Optional arguments</h4><p>The syntax for optional arguments is<ul><li><code>defun function-name (&optional (arg1-name arg1-default) (arg2-name arg2-default))</code></li><li>In principle there is no limit to the number of optional arguments you can specify</li><li>Optional arguments are order dependant as with Standard ones, so if <span class="general-keyword">arg2</span> is to be specified, <span class="general-keyword">arg1</span> must be specified as well.</li></ul></p><div class="repl-example"><pre><span class="prompt" style="display: inline;">GDL-USER>&nbsp;&nbsp;</span><span class="command" style="margin-left: 0px;">(defun kinetic-energy (&optional (mass 5) (velocity 12)</span><span class="command-no-prefix" style="margin-left: 84px;">(div (* mass velocity velocity) 2))</span><span class="output">KINETIC-ENERGY</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy)</span></p><span class="output">360.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy 10)</span></p><span class="output">720.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy 10 24)</span></p><span class="output">2880.0</span></pre></div><p>The first call to <span class="function">kinetic-energy</span> passes in no values for the arguments and so it ends up using both default optional values.
The second call uses a supplied value for <span class="slot">mass</span> but the default value for <span class="slot">velocity</span>. And the third call to <span class="function">kinetic-energy</span> uses supplied values for <span class="slot">mass</span> and <span class="slot">velocity</span>. Note that when defined in this way, in order to used a specified <span class="slot">velocity</span>, then <span class="slot">mass</span> must be supplied, even if given simply 
as its default value</p><h4>Keyword arguments</h4><p>The syntax for keyword arguments is<ul><li><code>defun function-name (&key (arg1-key arg1-default) (arg2-key arg2-deefault))</code></li><li>As with Optional arguments, there is no limit to the number of
keyword arguments you can specify</li><li>Contrasted with Standard and Optional arguments, you can call a function with
Keyword arguments with those argument values specified in any order (because each one is identified explicitly
by a keyword symbol in the definition of the function. This is a significant advantage over Optional and Standard
arguments, especially when you want to extend a function to accept new arguments without breaking existing code
which is calling it.</li><li>As with Optional arguments, you only need to specify the keyword arguments you want to use
when calling the function, and any arguments which you do not include in the call will take on their default values when
the body of the function is being evaluated.</li></ul></p><div class="repl-example"><pre><span class="prompt" style="display: inline;">GDL-USER>&nbsp;&nbsp;</span><span class="command" style="margin-left: 0px;">(defun kinetic-energy (&key (mass 5) (velocity 12)</span><span class="command-no-prefix" style="margin-left: 84px;">(div (* mass velocity velocity) 2))</span><span class="output">KINETIC-ENERGY</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy)</span></p><span class="output">360.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy :mass 10)</span></p><span class="output">720.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy :velocity 24)</span></p><span class="output">1440.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(kinetic-energy :velocity 24 :mass 10)</span></p><span class="output">2880.0</span></pre></div><p>Above we can see how the order-dependency is removed</p><p>Some general recomendations and observations:<ul><li>If there is only one argument then it's reasonable to use a Standard argument</li><li>Optional arguments will be easy to work with if there is only one of
them, a bit less easy if there are two, and will start becoming
unwieldy to work with if you use more than 2 Optional
arguments.

Additionally, thought needs to be given to the order in
which they are defined to avoid having to specify optional arguments
just to occupy a space in the argument list (e.g. if you have two optional arguments,
list first the one which is more likely to be passed in as a non-default value in calls to that function.</li><li>Keyword arguments work well when the function has more than 1 argument, and help with readability</li><li>Optional and Keyword arguments are relatively 'expensive' at runtime
compared with Standard arguments, so particularly with Keyword
arguments you may be trading Convenience for Speed in some cases (such cases can be shaken out
with Runtime Profiling)</li></ul></p><h3>GendL object <span class="object-keyword">:functions</span></h3><p>A GendL object function is defined in the <span class="object-keyword">:functions</span> section of an object definition made with the <span class="macro">define-object</span> macro. The function only "exists" in the context of the object
definition itself, but it can reference all of the slots within the
object directly, rather than you having to pass in values as
arguments. But of course it can also accept passed-in arguments. The
argument syntax is identical to that for Named Functions (this style
of argument list is called a "lambda list". The Named
Function <span class="function">kinetic-energy</span> shown above,
when defined as a GendL object function, may look like this:</p></div></div><div class="main-page-container"><div class="main-page-item"><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(defun kinetic-energy (&key (mass 5) (velocity 12)</span><span class="code" style="margin-left: 14px;">(div (* mass velocity velocity) 2)))</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 0px;">(define-object function-example(base-object)</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 0px;">:computed-slots</span><span class="code" style="margin-left: 0px;">((mass 5)</span><span class="code" style="margin-left: 7px;">(velocity 12)</span><span class="code" style="margin-left: 7px;">(ke-1 (the kinetic-energy-1))</span><span class="code" style="margin-left: 7px;">(ke-2 (the kinetic-energy-2))</span><span class="code" style="margin-left: 7px;">(ke-3 (the (kinetic-energy-2 :mass 10)))</span><span class="code" style="margin-left: 7px;">(ke-4 (the (kinetic-energy-2 :velocity 24)))</span><span class="code" style="margin-left: 7px;">(ke-5 (the (kinetic-energy-2 :velocity 24 :mass 10)))</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 7px;">(ke-6 (kinetic-energy :mass 10 :velocity 24))</span><span class="code" style="margin-left: 7px;">)</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 0px;">:functions</span><span class="code" style="margin-left: 0px;">((kinetic-energy-1 () (div (* (the mass) (the velocity) (the velocity)) 2))</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 7px;">(kinetic-energy-2 (&key (mass (the mass)) (velocity (the velocity)))</span><span class="code" style="margin-left: 56px;">(div (* mass velocity velocity) 2))</span><span class="code" style="margin-left: 7px;">)</span><span class="code" style="margin-left: 0px;">)</span></pre></div></div><div class="main-page-item"><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'function-example))</span></p><span class="output">#&#60;GDL-USER::FUNCTION-EXAMPLE #x210397F77D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-1)</span></p><span class="output">360.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-2)</span></p><span class="output">360.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-3)</span></p><span class="output">720.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-4)</span></p><span class="output">1440.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-5)</span></p><span class="output">2880.0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the ke-6)</span></p><span class="output">2880.0</span></pre></div></div></div><div class="grid-container-2-650px"><div class="grid-item"><p>Some points to note from the above example<ul><li>The <span class="object-keyword">:function</span> <span class="function">kinetic-energy-1</span> has no arguments but it references the <span class="object-keyword">:computed-slots</span> <span class="slot">mass</span> and <span class="slot">velocity</span> directly using the <span class="macro">the</span> macro</li><li>The <span class="object-keyword">:function</span> <span class="function">kinetic-energy-2</span> defines keyword arguments for <span class="slot">mass</span> and <span class="slot">veocity</span> and sets their default values to the values of the <span class="object-keyword">:computed-slots</span> <span class="slot">mass</span> and <span class="slot">velocity</span>.</li><li>When a <span class="object-keyword">:function</span> is called without arguments, the <span class="macro">the</span> referencing macro is still used but the <span class="object-keyword">:function</span> does not need enclosing in parentheses (so
such a reference would look just like a reference to a <span class="object-keyword">:computed-slot</span> (see <span class="object-keyword">:computed-slots</span> above)</li><li>When a <span class="object-keyword">:function</span> is called with arguments, whilst the <span class="macro">the</span>
referencing macro is again used, you must wrap the function name and
arguments with parentheses, similar to calling a normal Named function
with the only difference being an outer wrapping referencing macro e.g. <code>(the ... )</code> (see the <span class="object-keyword">:computed-slots</span> <span class="slot">ke-3</span>, <span class="slot">ke-4</span> and <span class="slot">ke-5</span></li><li>Compare and contrast these <span class="object-keyword">:computed-slots</span> with the way in which the <span class="function">kinetic-energy</span> Named Function is used for <span class="slot">ke-6</span></li></ul></p></div></div></div><div class="main-page-item"><h2>Resources</h2><table><tr><td><a href="/t2-resources/functions.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/functions.lisp">functions.lisp</a></td></tr></table></div></div></div></div></div></body></html>