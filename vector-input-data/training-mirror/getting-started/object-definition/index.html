<!DOCTYPE HTML><html lang="en"><head><title>Defining Objects</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>Defining Objects</h2><p><a class="text-red-500" href="/getting-started/instantiate-geysr/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/getting-started/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/getting-started/numbers-and-arithmetic/index.html">Next-&gt;</a></p><p>Recall on the slide about <a href="/getting-started/instantiate-repl/index.html">Instantiating Objects in the REPL</a>, we defined our own object using the Gendl <span class="macro">define-object</span> macro similarly to the following:</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-1a (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">((length 2)</span><span class="code" style="margin-left: 14px;">(width 3)</span><span class="code" style="margin-left: 14px;">(height 4)))</span></pre></div><p>In this section we will look a bit deeper into <span class="macro">define-object</span>.</p><p>The syntax for <span class="macro">define-object</span> is:</p><p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object definition-name ([mixins*]) [specifications*])</span></pre></div></p><p>where:<dl><dt>definition-name</dt><dd>is a symbol naming the object being defined.</dd><dt>mixins*</dt><dd>means zero or more symbols naming other object definitions,
from which this object type will inherit characteristics.</dd><dt>specifications*</dt><dd>comprise the body of the object definition and consist of a set
of keyword-value pairs which describe the characteristics and behaviors of any given instance of the object type.</dd></dl></p><h2>mixins</h2><p>In the above example, <span class="object">my-box-1a</span> specifies <span class="object">box</span> as a mixin. Because <span class="object">box</span> includes a built-in slot <span class="slot">volume</span> , <span class="object">my-box-1a</span> will also include a <span class="slot">volume</span> slot. The primitive <span class="object">box</span> also includes <span class="slot">length</span>, <span class="slot">width</span> and <span class="slot">height</span>, but specifies their default values each to be <span class="value">0</span>. In the example above, because <span class="object">my-box-1a</span> also includes <span class="slot">length</span>, <span class="slot">width</span>, and <span class="slot">height</span>, and assigns default values to them (<span class="value">2</span>, <span class="value">3</span> and <span class="value">4</span>, respectively), 
these values override the default <span class="value">0</span> values in any instances we may make of <span class="object">my-box-1a</span> as long as we do not feed in any other specific values at
instantiation-time.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'box)</span></p><span class="output">#&#60;BOX #x210348242D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the width)</span></p><span class="output">0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the height)</span></p><span class="output">0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">0</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-1a)</span></p><span class="output">#&#60;BOX #x210348242D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the width)</span></p><span class="output">3</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the height)</span></p><span class="output">4</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">24</span></pre></div><p>If you specify multiple mixins, precedence on the slots is left to right (and depth-first).</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-1b ()</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">((length 2)</span><span class="code" style="margin-left: 14px;">(width 3)</span><span class="code" style="margin-left: 14px;">(height 4)))</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 0px;">(define-object my-box-2 (my-box-1b box))</span><span class="code" style="margin-left: 7px;"></span><span class="code" style="margin-left: 0px;">(define-object my-box-3 (box my-box-1b))</span><span class="code" style="margin-left: 7px;"></span></pre></div><br /><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-2)</span></p><span class="output">#&#60;MY-BOX-2 #x210346742D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">2</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-3)</span></p><span class="output">#&#60;MY-BOX-3 #x210349442D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">0</span></pre></div><h2>specifications</h2><p>The specifications section is what really defines the object.
 This can be thought of as its computational DNA.</p><p>Each section of the specification is identified by one of a few supported keyword symbols.
The most common ones are:<ul class="list-disc list-outside ml-3 mr-8 bg-zinc-100"><li><span class="object-keyword">:input-slots</span></li><li><span class="object-keyword">:computed-slots</span></li><li><span class="object-keyword">:objects</span></li><li><span class="object-keyword">:functions</span></li></ul></p><h3><span class="object-keyword">:input-slots</span></h3><p><span class="object-keyword">:input-slots</span> specify any required and/or optional
inputs to the object. Each input-slot may be <dl><dt>a symbol</dt><dd>In this case it is a required input for the object.</dd><dt>a symbol-value pair enclosed in parentheses</dt><dd>in this case the slot is provided with a default value which may be overridden by <em>passing in</em> a different value, either from the parent object or from a toplevel call to the <span class="function">make-object</span> function.</dd></dl></p><p>In the example below, <span class="slot">length</span> is required, but <span class="slot">width</span> and <span class="slot">height</span> each default to <span class="value">4</span>.</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-4 (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">(length</span><span class="code" style="margin-left: 14px;">(width 4)</span><span class="code" style="margin-left: 14px;">(height 4)))</span></pre></div><p>If <span class="object">my-box-4</span> is instantiated, and <span class="slot">length</span> (or any attribute which depends on <span class="slot">length</span>) is evaluated, then an error 
will result, as <span class="slot">length</span> does not have a value. In other words, to be of any use,
 this object must be instantiated with <span class="slot">length</span> passed in explicitly
as an input.</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-4))</span></p><span class="output">#&#60;MY-BOX-4 #x2103467C4D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">Invoking restart: Return to SLIME's top level.</span><span class="error">; Evaluation aborted on #&#60;SIMPLE-ERROR #x21056CE7DD>.</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">Invoking restart: Return to SLIME's top level.</span><span class="error">; Evaluation aborted on #&#60;SIMPLE-ERROR #x21056B76DD>.</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-4 :length 3))</span></p><span class="output">#&#60;MY-BOX-4 #x21034F4C4D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the length)</span></p><span class="output">3</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">48</span></pre></div><p><span class="object-keyword">:input-slots</span> which have default 
values may have those values over-ridden when the object is instantiated</p><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(setq self (make-object 'my-box-4 :length 3 :width 10))</span></p><span class="output">#&#60;MY-BOX-4 #x21034F4C4D></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the volume)</span></p><span class="output">120</span></pre></div><h3><span class="object-keyword">:computed-slots</span></h3><p><span class="object-keyword">:computed-slots</span> can represent 
known values, intermediate results, or final outputs which may be computed by an object</p><p>They are defined as symbol-value pairs enclosed in parentheses. 
The value can be any Common Lisp value or expression.</p><p><span class="object-keyword">:computed-slots</span> can refer to the return values of other <span class="object-keyword">:computed-slots</span> using the GendL macro <span class="macro">the</span></p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object my-box-4 (box)</span><span class="code" style="margin-left: 7px;">:input-slots</span><span class="code" style="margin-left: 7px;">(length</span><span class="code" style="margin-left: 14px;">(width 4)</span><span class="code" style="margin-left: 14px;">(height 4)))</span><span class="code" style="margin-left: 7px;">:computed-slots</span><span class="code" style="margin-left: 7px;">((density 7800)</span><span class="code" style="margin-left: 14px;">(mass (* (div (the volume) 1000000000) (the density)))))</span></pre></div><p>In the example above, a computed-slot <span class="slot">density</span> has been created and set to <span class="value">7800</span> (the density of steel in kg/m<sup>3</sup>). A further slot has 
been created, <span class="slot">mass</span>, which divides the <span class="slot">volume</span> by <span class="value">1000000</span> and then multiplies that 
result by the value of <span class="slot">density</span></p><p><em>A point to note here is the Gendl is dimensionless. 
It is the responsibility of the programmer to ensure units are correct when performing 
calculations. Implicit in the example here is that length, width and height are specified 
in mm and the resultant mass will be in kg</em></p><p>We will cover the use of functions to perform calculations in 
more detail later in this tutorial</p><h3><span class="object-keyword">:objects</span></h3><p>The <span class="object-keyword">:objects</span> section is where child objects are specified. 
This specification includes:<dl><dt>The object name</dt><dd>i.e. the name of the slot which will contain this child object instance</dd><dt>The object type</dt><dd>This is expected to correspond to an object definition name specified in another <span class="function">define-object</span>. This can be a literal (quoted) symbol or
an expression which yields a symbol when evaluated (that is, object type can be determined dynamically at runtime).</dd><dt>The object input values</dt><dd>these are keyword-tagged expressions which specify the values to be passed (when and if demanded)
into the child object instance. They keywords should match existing <span class="slot">input-slots</span> in the child object's type, otherwise a compiler warning will be generated.</dd></dl></p><p>In the definition below, the parent object (<span class="object">assembly-1</span>) has two child objects: one called <span class="object">my-box</span> based on <span class="object">my-box-4</span> with <span class="slot">length</span> set to <span class="value">10</span>, and another called <span class="object">my-sphere</span>, based on the GendL <span class="object">sphere</span> object, with its <span class="slot">radius</span> specified as being equal to the <span class="slot">width</span> of <span class="slot">my-box</span></p><p>Note that when specifying the inputs to an object<ul class="list-disc list-outside ml-3 mr-8 bg-zinc-100"><li>the name must match one of the symbols in the object's <span class="object-keyword">:input-slots</span>.</li><li>the name must be specified as a keyword (ie preceeded by a <b><code>:</code></b>) so an <span class="object-keyword">:input-slot</span> <span class="slot">length</span> is specified as <b>:length</b> when specifying the inputs.</li></ul></p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object assembly-1 (base-object)</span><span class="code" style="margin-left: 7px;">:objects</span><span class="code" style="margin-left: 7px;">((my-box :type 'my-box-4</span><span class="code" style="margin-left: 70px;">:length 10)</span><span class="code" style="margin-left: 14px;">(my-sphere :type 'sphere</span><span class="code" style="margin-left: 91px;">:radius (the my-box width))))</span></pre></div><p>Instantiating assembly-1 in Geysr and drawing the leaves will 
look like this</p><img src="/t2-images/assembly-1.png" style="width: auto; height: 200px;" /><h3><span class="object-keyword">:functions</span></h3><p>The <span class="object-keyword">:functions</span> section is where 
you put the names, argument lists and bodies for <span class="object-keyword">:functions</span> which can operate 
within the context of the Gendl object they are defined in. They shouldn't be confused with Common Lisp functions which are 
defined with <em><b>defun</b></em>, although the syntax is very similar. The biggest 
difference is that a Gendl <span class="object-keyword">:function</span> can access messages 
within the object it is defined in by using the Gendl <span class="macro">the</span> macro</p><p>We will cover more on <span class="object-keyword">:functions</span> in a later part of this tutorial</p><div class="main-page-item"><h2>Resources</h2><table><tr><td><a href="/t2-resources/define-object.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t2-resources/define-object.lisp">define-object.lisp</a></td></tr></table></div></div></div></div></body></html>