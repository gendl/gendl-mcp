<!DOCTYPE HTML><html lang="en"><head><title>:settable slots</title><meta charset="UTF-8" /><link rel="icon" type="image/png" href="/gorn.png" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="stylesheet" href="/css/training-style.css" /><script src="/static/3rdpty/x3dom/x3dom.js" id="x3dom_script"></script><script id="svg-panzoom" src="/static/3rdpty/svgpanzoom/svg-pan-zoom.min.js"></script><script>
var gdliid = '/shared';</script><script src="/static/gwl/js/gdlajax1595.js"></script></head><body><div class="container mx-auto"><div class="main-page-item"><div class="mt-1 ml-2 mr-5"><h2>:settable slots</h2><p><a class="text-red-500" href="/more-objects/objects/index.html">&lt;-Previous</a><span class="font-bold"> | </span><a class="text-blue-500" href="/more-objects/index.html">^UP^</a><span class="font-bold"> | </span><a class="text-green-500" href="/more-objects/index-page/index.html">Next-&gt;</a></p><div class="grid-container-2-650px"><div class="grid-item"><p>In the <a href="/getting-started/index.html">Getting Started with GendL</a> tutorial, we identified on of the biggest differences between GendL and other programming languages was that slot evaluation was always demand driven and the inbuilt dependency tracker will always ensure slot values are current whenever any input changes. This removes a big burdon from the developer and also ensures run times are fast, as we are never calculating any values we don't need to use.</p><p>However, there may be times when we need to make programatic changes to values an over-ride this default behaviour. To do this, we identify either slots as <span class="general-keyword">:settable</span> and then we use the <span class="function">set-slot!</span> function to programaically alter the value of the selected slot.</p><p>When we make a change to a slot value by programatically setting it, the dependency tracker is aware of this and any changes which would ordinarily cause the value to be updated are suspended. If we want to reverse this behaviour (back to default) we can use either of the <span class="function">restore-slot-default!</span> or <span class="function">restore-slot-defaults!</span> functions</p><p>As with a lot of different techniques, programatically altering slot values and over-riding the default behaviour has its place and is a useful additoon to the tools and techniques available to the programmer. However, we need to be aware that at the point we do this, and until we revert to default behaviour, it becomes to responsibility of the developer to manage dependencies. For this reason it is recommended to use this technique sparingly and only when a solution using the default behaviour will not give the desired results</p><p>Consider the following code</p><div class="code-example"><pre><span class="code" style="margin-left: 0px;">(define-object settable-slots (base-object)</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 14px;">:computed-slots</span><span class="code" style="margin-left: 14px;">((speed 25 :settable)</span><span class="code" style="margin-left: 21px;">(time 15 :settable)</span><span class="code" style="margin-left: 21px;">(distance (* (the speed) (the time)) :settable))</span><span class="code" style="margin-left: 0px;"></span><span class="code" style="margin-left: 14px;">:functions</span><span class="code" style="margin-left: 14px;">((set-speed! (&key (value 20)) (the (set-slot! :speed value)))</span><span class="code" style="margin-left: 21px;">(set-time! (&key (value 10)) (the (set-slot! :time value)))</span><span class="code" style="margin-left: 21px;">(set-distance! () (the (set-slot! :distance 100)))</span><span class="code" style="margin-left: 21px;">(reset-distance! () (the (restore-slot-default! :distance)))</span><span class="code" style="margin-left: 21px;">(reset-all! () (the (restore-slot-defaults! (list :speed :time :distance))))))</span></pre></div><p>3 <span class="object-keyword">:computed slots</span>, <span class="slot">speed</span>, <span class="slot">time</span> and <span class="slot">distance</span> have been tagged as <span class="general-keyword">:settable</span>. 5 functions have been defined, 3 which set new values (using <span class="function">set-slot!</span>) for the respective slots and 2 which will restore default values and behaviours (using <span class="function">:restore-slot-default!</span> and <span class="function">:restore-slot-defaults!</span>). If we make the object and evaluate distance we get the following<div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(make-self 'settable-slots)</span></p><span class="output">#&#60;SETTABLE-SLOTS #x2104DC5DFD></span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">375</span></pre></div>We can now programatically change the value of speed by running the <span class="function">set-speed!</span> function. If we evaluate <span class="slot">distance</span>, we can see that<ul><li>The value has changed</li><li>But the underlying calculation is being performed as specified</li></ul><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the set-speed!)</span></p><span class="output">NIL</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">300</span></pre></div>We can do the same with <span class="slot">time</span>, getting the same results<div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the set-time!)</span></p><span class="output">NIL</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">200</span></pre></div>If we now modify the value of <span class="slot">distance</span>, we can see the change in that value, but then going back and changing the value of <span class="slot">speed</span> again, we can see that <span class="slot">distance</span> has not been changed. This is because <span class="slot">distance</span> has had its value set and any dependency tracking associated with it, which would ordinarily cause a change to its value, has been disabled<div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the set-distance!)</span></p><span class="output">NIL</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">100</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the (set-speed! :value 30))</span></p><span class="output">NIL</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">100</span></pre></div>However, if we now reset the value of <span class="slot">distance</span> only, we can see that dependency tracking has picked up the values of <span class="slot">speed</span> and <span class="slot">time</span> and has updated the value for <span class="slot">distance</span><div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the reset-distance!)</span></p><span class="output">:DISTANCE</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">300</span></pre></div>Finally, if we reset all slots, all are set back to default<div class="repl-example"><pre><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the reset-all!)</span></p><span class="output">(:SPEED :TIME :DISTANCE)</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the speed)</span></p><span class="output">25</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the time)</span></p><span class="output">15</span><p style="display: inline;"><span class="prompt" style="display: inline;">GDL-USER>&nbsp;</span><span class="command" style="display: inline;">(the distance)</span></p><span class="output">375</span></pre></div></p></div><div class="grid-item"><h2>Resources</h2><table><tr><td><a href="/t5-resources/settable-slots.lisp"><img src="/common-images/lisp-file.png" style="width: 40px; height: auto;" /></a></td><td><a href="/t5-resources/settable-slots.lisp">settable-slots.lisp</a></td></tr></table></div></div></div></div></div></body></html>